package org.example.cooking_recipe_bot.utils;

import org.example.cooking_recipe_bot.db.entity.Recipe;
import org.junit.jupiter.api.Test;

import java.text.ParseException;

import static org.junit.jupiter.api.Assertions.*;

class RecipeParserTest {

    @Test
    void testParseRecipeFromString() {

        String recipeString = "Ð§ÐµÑ‡ÐµÐ²Ð¸Ñ‡Ð½Ñ‹Ðµ Ð¾Ð»Ð°Ð´ÑŒÐ¸\n" +
                "â€¢ ÐŸÐ¾Ð» ÑÑ‚Ð°ÐºÐ°Ð½Ð° ÐºÐ¾Ð»Ð¾Ñ‚Ð¾Ð¹ Ñ‡ÐµÑ‡ÐµÐ²Ð¸Ñ†Ñ‹ (Ð·Ð°Ð¼Ð¾Ñ‡Ð¸Ñ‚ÑŒ Ð½Ð° Ð½Ð¾Ñ‡ÑŒ Ð¸Ð»Ð¸ Ñ‡Ð°ÑÐ° Ð½Ð° 3 (ÑÐ¼ Ñ„Ð¾Ñ‚Ð¾)\n" +
                "â€¢ 1 ÐºÑ€Ð°ÑÐ½Ñ‹Ð¹ Ð¿ÐµÑ€ÐµÑ†\n" +
                "â€¢ Ð›ÑƒÐº Ñ€ÐµÐ¿Ñ‡Ð°Ñ‚Ñ‹Ð¹\n" +
                "â€¢ ÐŸÑƒÑ‡Ð¾Ðº Ð»ÑŽÐ±Ð¾Ð¹ Ð·ÐµÐ»ÐµÐ½Ð¸\n" +
                "â€¢ 1 ÑÐ¹Ñ†Ð¾\n" +
                "â€¢ Ð¡Ð¾Ð»ÑŒ/Ð¿ÐµÑ€ÐµÑ†/Ñ‡ÐµÑÐ½Ð¾Ðº Ñ‡ÐµÑ€ÐµÐ· Ñ‡ÐµÑÐ½Ð¾ÐºÐ¾Ð´Ð°Ð²ÐºÑƒ\n" +
                "Ð§ÐµÑ‡ÐµÐ²Ð¸Ñ†Ñƒ Ð¿Ñ€Ð¾Ð¼Ñ‹Ñ‚ÑŒ, Ð»ÑƒÐº Ð¸ Ð¼Ð¾Ñ€ÐºÐ¾Ð²ÑŒ Ð¿Ð¾Ñ€ÐµÐ·Ð°Ñ‚ÑŒ Ð¸ Ð±Ñ‹ÑÑ‚Ñ€Ð¾ Ð¾Ð±Ð¶Ð°Ñ€Ð¸Ñ‚ÑŒ, ÑÐ¾ÐµÐ´Ð¸Ð½Ð¸Ñ‚ÑŒ Ð²ÑÐµ ÐºÑ€Ð¾Ð¼Ðµ ÑÐ¹Ñ†Ð° Ð¸ Ð¸Ð·Ð¼ÐµÐ»ÑŒÑ‡Ð¸Ñ‚ÑŒ Ð² Ð±Ð»ÐµÐ½Ð´ÐµÑ€Ðµ Ð´Ð¾ Ð¾Ð´Ð½Ð¾Ñ€Ð¾Ð´Ð½Ð¾Ð¹ Ð¼Ð°ÑÑÑ‹, Ð´Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð½ÐµÐ¼Ð½Ð¾Ð³Ð¾ Ð²Ð¾Ð´Ñ‹ (~50Ð¼Ð»). " +
                "ÐšÐ¾Ð½ÑÐ¸ÑÑ‚ÐµÐ½Ñ†Ð¸Ñ ÑÐ¼ÐµÑ‚Ð°Ð½Ñ‹ Ð´Ð¾Ð»Ð¶Ð½Ð° Ð±Ñ‹Ñ‚ÑŒ. Ð’Ð¼ÐµÑˆÐ°Ñ‚ÑŒ ÑÐ¹Ñ†Ð¾ Ð¸ Ð¶Ð°Ñ€Ð¸Ñ‚ÑŒ Ð½Ð° Ð°Ð¿ ÑÐºÐ¾Ð²Ð¾Ñ€Ð¾Ð´ÐºÐµ (Ñ Ð¿ÐµÑ€Ð²ÑƒÑŽ Ð¿Ð°Ñ€Ñ‚Ð¸ÑŽ Ð½Ð° Ð¼Ð°ÑÐ»Ðµ Ð³Ñ…Ð¸, Ð¿Ð¾Ñ‚Ð¾Ð¼ Ð±ÐµÐ·). ÐžÐ³Ð¾Ð½ÑŒ ÑÐ»Ð°Ð±Ñ‹Ð¹, Ð¿Ð¾ ~3 Ð¼Ð¸Ð½ÑƒÑ‚Ñ‹ Ñ ÐºÐ°Ð¶Ð´Ð¾Ð¹ ÑÑ‚Ð¾Ñ€Ð¾Ð½Ñ‹.\n" +
                "Ð¡ Ð³Ñ€ÐµÑ‡ÐµÑÐºÐ¸Ð¼ Ð¹Ð¾Ð³ÑƒÑ€Ñ‚Ð¾Ð¼+ ÑÐ¾ÐµÐ²Ñ‹Ð¹ Ð¿Ñ€Ð¾ÑÑ‚Ð¾ ÑƒÐ¼ Ð¾Ñ‚ÑŠÐµÑÑ‚ÑŒ â¤ï¸â€ðŸ”¥\n" +
                "#20Ð¼Ð¸Ð½ÑƒÑ‚ #ÑƒÐ¶Ð¸Ð½ #Ð¾Ð±ÐµÐ´ #Ð¿Ð¿";


        Recipe recipe = null;
        try {
            recipe = RecipeParser.parseRecipeFromString(recipeString);
        } catch (ParseException e) {
            e.printStackTrace();

        }


        assertEquals("Ñ‡ÐµÑ‡ÐµÐ²Ð¸Ñ‡Ð½Ñ‹Ðµ Ð¾Ð»Ð°Ð´ÑŒÐ¸", recipe.getName());

        assertEquals("ÐŸÐ¾Ð» ÑÑ‚Ð°ÐºÐ°Ð½Ð° ÐºÐ¾Ð»Ð¾Ñ‚Ð¾Ð¹ Ñ‡ÐµÑ‡ÐµÐ²Ð¸Ñ†Ñ‹ (Ð·Ð°Ð¼Ð¾Ñ‡Ð¸Ñ‚ÑŒ Ð½Ð° Ð½Ð¾Ñ‡ÑŒ Ð¸Ð»Ð¸ Ñ‡Ð°ÑÐ° Ð½Ð° 3 (ÑÐ¼ Ñ„Ð¾Ñ‚Ð¾)\n" +
                "1 ÐºÑ€Ð°ÑÐ½Ñ‹Ð¹ Ð¿ÐµÑ€ÐµÑ†\n" +
                "Ð›ÑƒÐº Ñ€ÐµÐ¿Ñ‡Ð°Ñ‚Ñ‹Ð¹\n" +
                "ÐŸÑƒÑ‡Ð¾Ðº Ð»ÑŽÐ±Ð¾Ð¹ Ð·ÐµÐ»ÐµÐ½Ð¸\n" +
                "1 ÑÐ¹Ñ†Ð¾\n" +
                "Ð¡Ð¾Ð»ÑŒ/Ð¿ÐµÑ€ÐµÑ†/Ñ‡ÐµÑÐ½Ð¾Ðº Ñ‡ÐµÑ€ÐµÐ· Ñ‡ÐµÑÐ½Ð¾ÐºÐ¾Ð´Ð°Ð²ÐºÑƒ", recipe.getIngredients());

        assertEquals("Ð§ÐµÑ‡ÐµÐ²Ð¸Ñ†Ñƒ Ð¿Ñ€Ð¾Ð¼Ñ‹Ñ‚ÑŒ, Ð»ÑƒÐº Ð¸ Ð¼Ð¾Ñ€ÐºÐ¾Ð²ÑŒ Ð¿Ð¾Ñ€ÐµÐ·Ð°Ñ‚ÑŒ Ð¸ Ð±Ñ‹ÑÑ‚Ñ€Ð¾ Ð¾Ð±Ð¶Ð°Ñ€Ð¸Ñ‚ÑŒ, ÑÐ¾ÐµÐ´Ð¸Ð½Ð¸Ñ‚ÑŒ Ð²ÑÐµ ÐºÑ€Ð¾Ð¼Ðµ ÑÐ¹Ñ†Ð° Ð¸ Ð¸Ð·Ð¼ÐµÐ»ÑŒÑ‡Ð¸Ñ‚ÑŒ Ð² Ð±Ð»ÐµÐ½Ð´ÐµÑ€Ðµ Ð´Ð¾ Ð¾Ð´Ð½Ð¾Ñ€Ð¾Ð´Ð½Ð¾Ð¹ Ð¼Ð°ÑÑÑ‹, Ð´Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð½ÐµÐ¼Ð½Ð¾Ð³Ð¾ Ð²Ð¾Ð´Ñ‹ (~50Ð¼Ð»). " +
                "ÐšÐ¾Ð½ÑÐ¸ÑÑ‚ÐµÐ½Ñ†Ð¸Ñ ÑÐ¼ÐµÑ‚Ð°Ð½Ñ‹ Ð´Ð¾Ð»Ð¶Ð½Ð° Ð±Ñ‹Ñ‚ÑŒ. Ð’Ð¼ÐµÑˆÐ°Ñ‚ÑŒ ÑÐ¹Ñ†Ð¾ Ð¸ Ð¶Ð°Ñ€Ð¸Ñ‚ÑŒ Ð½Ð° Ð°Ð¿ ÑÐºÐ¾Ð²Ð¾Ñ€Ð¾Ð´ÐºÐµ (Ñ Ð¿ÐµÑ€Ð²ÑƒÑŽ Ð¿Ð°Ñ€Ñ‚Ð¸ÑŽ Ð½Ð° Ð¼Ð°ÑÐ»Ðµ Ð³Ñ…Ð¸, Ð¿Ð¾Ñ‚Ð¾Ð¼ Ð±ÐµÐ·). ÐžÐ³Ð¾Ð½ÑŒ ÑÐ»Ð°Ð±Ñ‹Ð¹, Ð¿Ð¾ ~3 Ð¼Ð¸Ð½ÑƒÑ‚Ñ‹ Ñ ÐºÐ°Ð¶Ð´Ð¾Ð¹ ÑÑ‚Ð¾Ñ€Ð¾Ð½Ñ‹.\n" +
                "Ð¡ Ð³Ñ€ÐµÑ‡ÐµÑÐºÐ¸Ð¼ Ð¹Ð¾Ð³ÑƒÑ€Ñ‚Ð¾Ð¼+ ÑÐ¾ÐµÐ²Ñ‹Ð¹ Ð¿Ñ€Ð¾ÑÑ‚Ð¾ ÑƒÐ¼ Ð¾Ñ‚ÑŠÐµÑÑ‚ÑŒ â¤ï¸â€ðŸ”¥", recipe.getInstructions());

        assertEquals("20Ð¼Ð¸Ð½ÑƒÑ‚\n" +
                "ÑƒÐ¶Ð¸Ð½\n" +
                "Ð¾Ð±ÐµÐ´\n" +
                "Ð¿Ð¿", recipe.getHashtags());

    }
    @Test
    void testParseRecipeFromString2() {
        String recipeString = "Ð§Ð•Ð¡ÐÐžÐ§ÐÐžÐ• ÐœÐÐ¡Ð›Ðž\n" +
                "â€¢ Ð¿Ð°Ñ‡ÐºÐ° Ð²ÐºÑƒÑÐ½Ð¾Ð³Ð¾ Ñ…Ð¾Ñ€Ð¾ÑˆÐµÐ³Ð¾ ÑÐ»Ð¸Ð²Ð¾Ñ‡Ð½Ð¾Ð³Ð¾ Ð¼Ð°ÑÐ»Ð°\n" +
                "â€¢ 2 Ñ‡Ð» ÐºÑ€ÑƒÐ¿Ð½Ð¾Ð¹ ÑÐ¾Ð»Ð¸\n" +
                "â€¢ Ð·ÐµÐ»ÐµÐ½ÑŒ, ÑƒÐºÑ€Ð¾Ð¿/Ð¿ÐµÑ‚Ñ€ÑƒÑˆÐºÐ°/Ð»ÑƒÑ‡Ð¾Ðº. Ð¿Ñ€ÑÐ¼ Ð¿ÑƒÑ‡Ð¾Ðº. Ð¼ÐµÐ»ÐºÐ¾ Ð¿Ð¾Ñ€ÐµÐ·Ð°Ñ‚ÑŒ\n" +
                "â€¢ 1/4 ÑÐ¾ÐºÐ° Ð»Ð¸Ð¼Ð¾Ð½Ð°\n" +
                "â€¢ Ñ‡ÐµÑÐ½Ð¾Ðº Ð·ÑƒÐ±Ñ‡Ð¸ÐºÐ° 4-5 Ñ‡ÐµÑ€ÐµÐ· Ñ‡ÐµÑÐ½Ð¾ÐºÐ¾Ð´Ð°Ð²Ð¸Ð»ÐºÑƒ\n" +
                "â€¢ Ñ€Ð¾Ð·Ð¾Ð²Ñ‹Ð¹ Ð¿ÐµÑ€ÐµÑ† Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾\n" +
                "ÐœÐ°ÑÐ»Ð¾ Ð¿Ñ€Ð¸ ÐºÐ¾Ð¼Ð½Ð°Ñ‚Ð½Ð¾Ð¹ Ñ‚ÐµÐ¼Ð¿ÐµÑ€Ð°Ñ‚ÑƒÑ€Ðµ Ð¿ÑƒÑÑ‚ÑŒ Ð¿Ð¾Ð»ÐµÐ¶Ð¸Ñ‚ Ð¿Ð¾ÐºÐ° Ð½Ðµ ÑÑ‚Ð°Ð½ÐµÑ‚ Ð¼ÑÐ³ÐºÐ¸Ð¼, ÑÐ¼ÐµÑˆÐ°Ñ‚ÑŒ Ð²Ð¸Ð»ÐºÐ¾Ð¹ Ð²ÑÐµ Ð¸Ð½Ð³Ñ€ÐµÐ´Ð¸ÐµÐ½Ñ‚Ñ‹, Ð²Ñ‹Ð»Ð¾Ð¶Ð¸Ñ‚ÑŒ ÐºÐ¾Ð»Ð±Ð°ÑÐ¾Ð¹ Ð½Ð° Ð¿ÐµÑ€Ð³Ð°Ð¼ÐµÐ½Ñ‚, Ð·Ð°Ð²ÐµÑ€Ð½ÑƒÑ‚ÑŒ Ð¸ Ð·Ð°Ð¼Ð¾Ñ€Ð¾Ð·Ð¸Ñ‚ÑŒ. \n" +
                "Ð¿Ñ€Ð¸ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ÑÑ‚Ð¸ Ð´Ð¾ÑÑ‚Ð°Ð²Ð°Ñ‚ÑŒ Ð¸ Ð¾Ñ‚Ñ€ÐµÐ·Ð°Ñ‚ÑŒ ÐºÑƒÑÐ¾Ñ‡ÐµÐº. \n" +
                "Ð¿Ð¾Ð´Ñ…Ð¾Ð´Ð¸Ñ‚ Ð´Ð»Ñ ÑÑ‚ÐµÐ¹ÐºÐ¾Ð²/Ð¼ÑÑÐ°/ÐºÐ¾Ñ‚Ð»ÐµÑ‚/Ñ€Ñ‹Ð±Ñ‹/ÐºÑƒÐºÑƒÑ€ÑƒÐ·Ñ‹ Ð¸ Ð¾Ð²Ð¾Ñ‰ÐµÐ¹ Ð½Ð° Ð³Ñ€Ð¸Ð»Ðµ/ÐºÐ°Ñ€Ñ‚Ð¾ÑˆÐºÐµ/ Ð½Ð° Ñ‚Ð¾ÑÑ‚ â€¦ Ð¸ Ð²ÐµÐ·Ð´Ðµ Ð¾Ð½Ð¾ Ð±ÑƒÐ´ÐµÑ‚ Ð¸Ð´ÐµÐ°Ð»ÑŒÐ½Ñ‹Ð¼ Ð´Ð¾Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸ÐµÐ¼.\n" +
                "#Ð¼Ð°ÑÐ»Ð¾ #Ð·Ð°ÐºÑƒÑÐºÐ° #Ð·Ð°Ð³Ð¾Ñ‚Ð¾Ð²ÐºÐ° #20Ð¼Ð¸Ð½ÑƒÑ‚";

        Recipe recipe = null;
        try {
            recipe = RecipeParser.parseRecipeFromString(recipeString);
        } catch (ParseException e) {
            e.printStackTrace();

        }

        assertEquals("Ñ‡ÐµÑÐ½Ð¾Ñ‡Ð½Ð¾Ðµ Ð¼Ð°ÑÐ»Ð¾", recipe.getName());
        assertEquals("Ð¿Ð°Ñ‡ÐºÐ° Ð²ÐºÑƒÑÐ½Ð¾Ð³Ð¾ Ñ…Ð¾Ñ€Ð¾ÑˆÐµÐ³Ð¾ ÑÐ»Ð¸Ð²Ð¾Ñ‡Ð½Ð¾Ð³Ð¾ Ð¼Ð°ÑÐ»Ð°\n" +
                "2 Ñ‡Ð» ÐºÑ€ÑƒÐ¿Ð½Ð¾Ð¹ ÑÐ¾Ð»Ð¸\n" +
                "Ð·ÐµÐ»ÐµÐ½ÑŒ, ÑƒÐºÑ€Ð¾Ð¿/Ð¿ÐµÑ‚Ñ€ÑƒÑˆÐºÐ°/Ð»ÑƒÑ‡Ð¾Ðº. Ð¿Ñ€ÑÐ¼ Ð¿ÑƒÑ‡Ð¾Ðº. Ð¼ÐµÐ»ÐºÐ¾ Ð¿Ð¾Ñ€ÐµÐ·Ð°Ñ‚ÑŒ\n" +
                "1/4 ÑÐ¾ÐºÐ° Ð»Ð¸Ð¼Ð¾Ð½Ð°\n" +
                "Ñ‡ÐµÑÐ½Ð¾Ðº Ð·ÑƒÐ±Ñ‡Ð¸ÐºÐ° 4-5 Ñ‡ÐµÑ€ÐµÐ· Ñ‡ÐµÑÐ½Ð¾ÐºÐ¾Ð´Ð°Ð²Ð¸Ð»ÐºÑƒ\n" +
                "Ñ€Ð¾Ð·Ð¾Ð²Ñ‹Ð¹ Ð¿ÐµÑ€ÐµÑ† Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾", recipe.getIngredients());
        assertEquals("ÐœÐ°ÑÐ»Ð¾ Ð¿Ñ€Ð¸ ÐºÐ¾Ð¼Ð½Ð°Ñ‚Ð½Ð¾Ð¹ Ñ‚ÐµÐ¼Ð¿ÐµÑ€Ð°Ñ‚ÑƒÑ€Ðµ Ð¿ÑƒÑÑ‚ÑŒ Ð¿Ð¾Ð»ÐµÐ¶Ð¸Ñ‚ Ð¿Ð¾ÐºÐ° Ð½Ðµ ÑÑ‚Ð°Ð½ÐµÑ‚ Ð¼ÑÐ³ÐºÐ¸Ð¼, ÑÐ¼ÐµÑˆÐ°Ñ‚ÑŒ Ð²Ð¸Ð»ÐºÐ¾Ð¹ Ð²ÑÐµ Ð¸Ð½Ð³Ñ€ÐµÐ´Ð¸ÐµÐ½Ñ‚Ñ‹, Ð²Ñ‹Ð»Ð¾Ð¶Ð¸Ñ‚ÑŒ ÐºÐ¾Ð»Ð±Ð°ÑÐ¾Ð¹ Ð½Ð° Ð¿ÐµÑ€Ð³Ð°Ð¼ÐµÐ½Ñ‚, Ð·Ð°Ð²ÐµÑ€Ð½ÑƒÑ‚ÑŒ Ð¸ Ð·Ð°Ð¼Ð¾Ñ€Ð¾Ð·Ð¸Ñ‚ÑŒ. \n" +
                "Ð¿Ñ€Ð¸ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ÑÑ‚Ð¸ Ð´Ð¾ÑÑ‚Ð°Ð²Ð°Ñ‚ÑŒ Ð¸ Ð¾Ñ‚Ñ€ÐµÐ·Ð°Ñ‚ÑŒ ÐºÑƒÑÐ¾Ñ‡ÐµÐº. \n" +
                "Ð¿Ð¾Ð´Ñ…Ð¾Ð´Ð¸Ñ‚ Ð´Ð»Ñ ÑÑ‚ÐµÐ¹ÐºÐ¾Ð²/Ð¼ÑÑÐ°/ÐºÐ¾Ñ‚Ð»ÐµÑ‚/Ñ€Ñ‹Ð±Ñ‹/ÐºÑƒÐºÑƒÑ€ÑƒÐ·Ñ‹ Ð¸ Ð¾Ð²Ð¾Ñ‰ÐµÐ¹ Ð½Ð° Ð³Ñ€Ð¸Ð»Ðµ/ÐºÐ°Ñ€Ñ‚Ð¾ÑˆÐºÐµ/ Ð½Ð° Ñ‚Ð¾ÑÑ‚ â€¦ Ð¸ Ð²ÐµÐ·Ð´Ðµ Ð¾Ð½Ð¾ Ð±ÑƒÐ´ÐµÑ‚ Ð¸Ð´ÐµÐ°Ð»ÑŒÐ½Ñ‹Ð¼ Ð´Ð¾Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸ÐµÐ¼.", recipe.getInstructions());
        assertEquals("Ð¼Ð°ÑÐ»Ð¾\nÐ·Ð°ÐºÑƒÑÐºÐ°\nÐ·Ð°Ð³Ð¾Ñ‚Ð¾Ð²ÐºÐ°\n20Ð¼Ð¸Ð½ÑƒÑ‚", recipe.getHashtags());
    }

    @Test
    void testParseRecipeFromString_EmptyRecipeString() {
        String recipeString = "";
        assertThrowsExactly(ParseException.class, () -> RecipeParser.parseRecipeFromString(recipeString));

    }

    @Test
    void testParseRecipeFromString_NoIngredients() {
        String recipeString = "Recipe Name\n\nInstructions\n#Hashtags";
        assertThrowsExactly(ParseException.class, () -> RecipeParser.parseRecipeFromString(recipeString));
    }

    @Test
    void testParseRecipeFromString_NoInstructions() {
        String recipeString = "Recipe Name\nâ€¢ Ingredients\n#Hashtags";
        assertThrows(ParseException.class, () -> RecipeParser.parseRecipeFromString(recipeString));
    }

    @Test
    void testParseRecipeFromString_NoHashtags() {
        String recipeString = "Recipe Name\nâ€¢ Ingredients\nInstructions";
        assertThrows(ParseException.class, () -> RecipeParser.parseRecipeFromString(recipeString));
    }

}